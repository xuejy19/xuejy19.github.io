---
title: 条件随机场
date: 2020-08-21 16:02:15
tags: 概率图，条件随机场
categories: 统计学习
toc: true
mathjax: true
---
另一种常用模型为条件随机场(CRF)模型,条件随机场是给定一组输入随机变量条件下另一组输出随机变量的条件概率分布模型，其特点是假设输出随机变量构成马尔可夫随机场。本章节按照以下几部分组织：
- 概率无向图模型
- 条件随机场定义与形式
- 条件随机场概率计算
- 条件随机场学习算法
- 条件随机场预测算法
<!--more-->

### 概率无向图模型
#### 概率无向图模型定义
图是由节点和及连接的边组成的集合，表示为$G = (V,E)$，若连接的边无方向，则称为无向图，反之则称为有向图。
概率图模型是由图表示的概率分布，图中的节点表示随机变量，节点之间的边表示变量之间的概率依赖关系。
给定一个联合概率分布$P(Y)$和表示它的无向图$G$,首先定义无向图表示的随机变量之间存在的成对马尔可夫性、局部马尔可夫性和全局马尔可夫性。
> - 成对马尔可夫性：设$\mu$和$v$是无向图$G$中任意两个没有边连接的节点，两个节点分别对应随机变量$Y_{\mu},Y_v$。其他所有节点的集合记做$O$,对应随机变量组是$Y_O$。成对马尔可夫性是指给定随机变量组$Y_O$的条件下，随机变量$Y_{\mu}$和$Y_v$是条件独立的,即：
$$
    P(Y_{\mu},Y_v|Y_O) = P(Y_{\mu}|Y_O)P(Y_{v}|Y_O)
$$
> - 局部马尔可夫性：设$v \in V$是无向图$G$中任意一个节点，$W$是与$v$有边连接的所有节点，$O$是$v$和$W$以外的其他所有节点。$v,W,O$对应的随机变量(组)记做$Y_v,Y_W,Y_O$,局部马尔可夫性是指在给定随机变量组$Y_W$条件下，随机变量$Y_v$与随机变量组$Y_O$是相互独立的:
$$
    P(Y_{O},Y_v|Y_W) = P(Y_{v}|Y_W)P(Y_{O}|Y_W)
$$
在$P(Y_O|Y_W)>0$情况下，有：
$$
    P(Y_v|Y_W) = P(Y_v|Y_W,Y_O)
$$
> - 全局马尔可夫性：设结点集合$A,B$是在无向图$G$中被节点集合$C$分开的任意节点集合，它们所对应的变量组记做$Y_A,Y_B,Y_C$。全局马尔可夫性是指给定随机变量组$Y_C$条件下随机变量组$Y_A，Y_B$是条件独立的，即：
$$
    P(Y_A,Y_B|Y_C) = P(Y_A|Y_C)P(Y_B|Y_C)
$$

下面定义概率无向图模型:
> **概率无向图模型:** 设有联合概率分布$P(Y)$，由无向图$G = (V,E)$表示，在图$G$中，节点表示随机变量，边表示随机变量之间的概率依赖关系。若联合概率分布$P(Y)$满足**成对、局部或全局马尔可夫性**,就称此概率分布为概率无向图模型，或马尔可夫随机场。

#### 概率无向图模型的因子分解
能够使用图模型来对联合概率分布进行编码，主要出发点便是变量之间的马尔可夫性假设，这让我们可以以更加紧凑的形式来表示联合概率分布。 
首先给出无向图中团与最大团的定义:
> **团与最大团**:无向图中任何两个节点均有边连接的子集称为团(clique)。若$C$是无向图$G$的一个团，并且不能够再加入任何一个$G$的节点使其成为一个更大的团，则称此$C$为最大团。

将概率无向图模型的联合概率分布表示为其最大团上的随机变量的函数的乘积的操作，称为概率无向图模型的因子分解。
给定概率图模型，设其无向图为$G$，$C$为$G$上的最大团，$Y_C$表示$C$对应的随机变量，那么联合概率分布$P(Y)$可以表示成图中所有最大团$C$上函数$\varPhi_C(Y_C)$的**连乘形式**:
$$
    P(Y) = \frac{1}{Z} \prod_{C} \varPhi_C(Y_C)
$$
公式中$Z$是一个归一化因子$Z = \sum_Y \prod_{C} \varPhi_C(Y_C)$。函数$\varPhi_C(Y_C)$称为势函数。势函数通常定义为指数函数:
$$
    \varPhi_C(Y_C) = exp\{ -E(Y_C)\}
$$
概率无向图的因子分解由Hammersley-Clifford定理保证:
> Hammersley-Clifford定理: 概率无向图模型的联合概率分布$P(Y)$可以表示为如下形式:
$$
    P(Y) = \frac{1}{Z} \prod_C \varPhi_C(Y_C)
$$
其中，$C$是无向图的最大团，$Y_C$是$C$的节点对应的随机变量，$\varPhi_C(Y_C)$是$C$上定义的严格正函数，乘积是在无向图所有的最大团上进行的，关于该定理的证明参考链接[Hammersley-Clifford定理证明](https://www.jianshu.com/p/dd27249b8c4a)

### 条件随机场的定义与形式
#### 条件随机场的定义
条件随机场是给定随机变量$X$条件下，随机变量$Y$的马尔可夫随机场。本文主要介绍线性链条件随机场，该模型可用于标注等问题。