---
title: logisticå›å½’ä¸æœ€å¤§ç†µæ¨¡å‹
date: 2020-08-23 15:16:31
tags: logisticå›å½’, æœ€å¤§ç†µæ¨¡å‹, ä¼˜åŒ–å­¦ä¹ 
categories: ç»Ÿè®¡å­¦ä¹ 
toc: true
mathjax: true
---
åœ¨å­¦ä¹ æèˆªè€å¸ˆã€Šç»Ÿè®¡å­¦ä¹ ã€‹æ¡ä»¶éšæœºåœºç« èŠ‚æ—¶ï¼Œå¯¹äºå­¦ä¹ ç®—æ³•æ„Ÿåˆ°æœ‰äº›é™Œç”Ÿï¼Œåæ¥å‘ç°åœ¨ä¹¦ä¸­ç¬¬å…­ç« â€œlogisticå›å½’ä¸æœ€å¤§ç†µæ¨¡å‹â€æœ‰è¿‡ä¸€äº›ä»‹ç»ï¼Œå› æ­¤æœ¬ç« èŠ‚ä¾¿æ€»ç»“ä¸€ä¸‹ç›¸å…³çŸ¥è¯†ï¼Œå…¶ä¸­logisticå›å½’æ¨¡å‹åšç®€è¦ä»‹ç»ï¼Œé‡ç‚¹æ”¾åœ¨æœ€å¤§ç†µæ¨¡å‹çš„å­¦ä¹ ç®—æ³•ä¸Šï¼Œæœ¬æ–‡æŒ‰ç…§å¦‚ä¸‹ç»“æ„ç»„ç»‡ï¼š
- logisticå›å½’
- æœ€å¤§ç†µæ¨¡å‹
- æ¨¡å‹å­¦ä¹ çš„æœ€ä¼˜åŒ–ç®—æ³•
<!--more-->
### logisticå›å½’
#### logisticåˆ†å¸ƒ
é¦–å…ˆä»‹ç»ä¸‹logisticåˆ†å¸ƒï¼š
> **logisticåˆ†å¸ƒ**:è®¾$X$æ˜¯è¿ç»­å˜é‡ï¼Œ$X$æœä»logisticåˆ†å¸ƒæ˜¯æŒ‡$X$å…·æœ‰ä¸‹åˆ—åˆ†å¸ƒå‡½æ•°å’Œå¯†åº¦å‡½æ•°ï¼š
> $$
    \begin{aligned}
        F(x) &= P(X \leq x) = \frac{1}{1 + e^{-\frac{x-\mu}{\gamma}}} \\
        f(x) &= F'(x) = \frac{e^{-\frac{x-\mu}{\gamma}}}{\gamma(1+e^{-\frac{x-\mu}{\gamma}})^2}
    \end{aligned}
> $$
> å¼ä¸­ï¼Œ$\mu$ä¸ºä½ç½®å‚æ•°ï¼Œ$\gamma>0$ä¸ºå½¢çŠ¶å‚æ•° 

å¯¹äºlogisticåˆ†å¸ƒï¼Œå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°å’Œåˆ†å¸ƒå‡½æ•°å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
![logistic](https://raw.githubusercontent.com/xuejy19/xuejy19.github.io/source/Img/logistic.jpeg)
åˆ†å¸ƒå‡½æ•°çš„å›¾å½¢æ˜¯ä¸€æ¡$S$å½¢æ›²çº¿ï¼Œè¯¥æ›²çº¿ä»¥ç‚¹$(\mu,\frac{1}{2})$ä¸ºä¸­å¿ƒå¯¹ç§°ï¼Œå³æ»¡è¶³:
$$
    F(-x+\mu) - \frac{1}{2} = -F(x+\mu) +\frac{1}{2}
$$
æ›²çº¿åœ¨ä¸­å¿ƒå¢é•¿é€Ÿåº¦è¾ƒå¿«ï¼Œåœ¨ä¸¤ç«¯å¢é•¿é€Ÿåº¦æ…¢ï¼Œå½¢çŠ¶å‚æ•°$\gamma$çš„å€¼è¶Šå°ï¼Œæ›²çº¿åœ¨ä¸­å¿ƒé™„è¿‘å¢é•¿å¾—è¶Šå¿«ã€‚
#### äºŒé¡¹logisticå›å½’æ¨¡å‹
äºŒé¡¹logisticå›å½’æ¨¡å‹æ˜¯ä¸€ç§äºŒåˆ†ç±»æ¨¡å‹ï¼Œç”±æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$P(Y|X)$è¡¨ç¤ºï¼Œå½¢å¼ä¸ºå‚æ•°åŒ–çš„logisticåˆ†å¸ƒï¼Œéšæœºå˜é‡$X$çš„å–å€¼ä¸ºå®æ•°ï¼Œéšæœºå˜é‡$Y$å–å€¼ä¸º1æˆ–0ï¼Œä¸‹é¢ç»™å‡ºlogisticå›å½’æ¨¡å‹å®šä¹‰ï¼š
> **logisticå›å½’æ¨¡å‹**ï¼šäºŒé¡¹logisticå›å½’æ¨¡å‹æ˜¯å¦‚ä¸‹æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒï¼š
> $$
    \begin{aligned}
        P(Y=1|x) &= \frac{exp(w \cdot x + b)}{1 + exp(w \cdot x + b)} \\
        P(Y=0|x) &= \frac{1}{1 + exp(w \cdot x + b)} 
    \end{aligned}
> $$
> å…¶ä¸­ï¼Œ$x \in R^n$æ˜¯è¾“å…¥ï¼Œ$Y \in \{0,1\}$æ˜¯è¾“å‡ºï¼Œ$w \in R^n,b \in R$æ˜¯å‚æ•°ã€‚

è‹¥æˆ‘ä»¬å·²ç»æœ‰äº†logisticæ¨¡å‹ï¼Œåˆ™åˆ¤æ–­æ ·æœ¬ç‚¹$x$å±äºå“ªä¸€ç±»åªéœ€è¦æ¯”è¾ƒä¸¤ä¸ªæ¦‚ç‡å€¼çš„å¤§å°ï¼Œä¸‹é¢ç»™å‡ºå¯¹æ•°å‡ ç‡çš„å®šä¹‰:
> **å¯¹æ•°å‡ ç‡**ï¼šä¸€ä¸ªäº‹ä»¶çš„å‡ ç‡æ˜¯æŒ‡è¯¥äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ä¸è¯¥äº‹ä»¶ä¸å‘ç”Ÿçš„æ¦‚ç‡çš„æ¯”å€¼ï¼Œå¦‚æœä¸€ä¸ªäº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡æ˜¯$p$,é‚£ä¹ˆè¯¥äº‹ä»¶çš„å‡ ç‡æ˜¯$\frac{p}{1-p}$,è¯¥äº‹ä»¶çš„å¯¹æ•°å‡ ç‡æˆ–logitå‡½æ•°æ˜¯:
> $$
    logit(p) = log \frac{p}{1-p}
> $$

å¯¹äºlogisticå›å½’è€Œè¨€ï¼Œäº‹ä»¶$(Y=1|X)$çš„å¯¹æ•°å‡ ç‡ä¸ºï¼š
$$
    log \frac{P(Y=1|x)}{1 - P(Y=1|x)} = w \cdot x
$$
è¿™è¯´æ˜ï¼Œlogisticå›å½’æ¨¡å‹å¯ä»¥çœ‹åšæ˜¯ç”¨çº¿æ€§å›å½’æ¨¡å‹å»é€¼è¿‘çœŸå®æ ‡è®°çš„å¯¹æ•°å‡ ç‡ã€‚å› æ­¤logisticå›å½’æ¨¡å‹ä¹Ÿè¢«ç§°ä¸ºå¯¹æ•°å‡ ç‡å›å½’ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ç»è¿‡äº†å¦‚ä¸‹çš„æ˜ å°„ç¯èŠ‚ï¼Œå°†$R^n$ç©ºé—´ä¸­çš„$x$æ˜ å°„åˆ°äº†å…¶æ ‡è®°çš„æ¦‚ç‡ï¼š
$$
    x \in R^n  \rightarrow w \cdot x \in R \rightarrow P(Y=1|x) \in [0,1]
$$

#### æ¨¡å‹å‚æ•°ä¼°è®¡
å¯¹äºlogisticå›å½’æ¨¡å‹ï¼Œéœ€è¦ä¼°è®¡çš„å‚æ•°æ˜¯$w,b$,å¯ä»¥è€ƒè™‘å°†å®ƒä»¬åˆå¹¶ä¸ºä¸€ä¸ª$n+1$ç»´å‘é‡:
$$
    w = [w;b]
$$
åŒæ—¶ï¼Œç»™è¾“å…¥å‘é‡åŠ ä¸€ç»´ï¼Œè¡¨ç¤ºä¸º:
$$
    x = [x;1]
$$
è¿™æ ·logisticå›å½’æ¨¡å‹å°±å¯ä»¥è¡¨ç¤ºæˆæ›´åŠ ç´§å‡‘çš„å½¢å¼:
$$
    \begin{aligned}
        P(Y=1|x) &=  \frac{exp(w \cdot x) }{1+exp(w \cdot x)} \\
        P(Y=0|x) &=  \frac{1}{1 + exp(w \cdot x)}
    \end{aligned}
$$
logisticæ¨¡å‹å‚æ•°å­¦ä¹ å±äºæœ‰ç›‘ç£çš„æ¨¡å‹å­¦ä¹ é—®é¢˜èŒƒç•´ï¼Œåˆ©ç”¨æå¤§ä¼¼ç„¶æ³•å°±å¯ä»¥è§£å†³ï¼Œè®¾ï¼š
$$
    P(Y=1|x) = \pi(x), \quad P(Y=0|x) = 1- \pi(x)
$$
ä¼¼ç„¶å‡½æ•°å¯ä»¥å†™æˆ:
$$
    \prod_{i=1}^N [\pi(x_i)]^{y_i} [1 - \pi(x_i)]^{1-y_i}
$$
å¯¹æ•°ä¼¼ç„¶å‡½æ•°ä¸º:
$$
    \begin{aligned}
        L(w) &= \sum_{i=1}^N [y_i log \pi(x_i) + (1-y_i)log(1-\pi(x_i))] \\
            &= \sum_{i=1}^N [y_i log \frac{\pi(x_i)}{1 - \pi(x_i)} + log(1-\pi(x_i))] \\
            &= \sum_{i=1}^N [y_i(w \cdot x) - log(1 + exp(w \cdot x))]
    \end{aligned}
$$
å¯¹$L(w)$æ±‚æå¤§å€¼ï¼Œå¾—åˆ°$w$çš„ä¼°è®¡å€¼ï¼Œå¸¸ç”¨æ¢¯åº¦ä¸‹é™æ³•åŠæ‹Ÿç‰›é¡¿æ³•æ±‚è§£(åé¢ä¸“å¼€ä¸€ç« è®²è§£)ã€‚
#### å¤šé¡¹logisticå›å½’
ä¸Šé¢ä»‹ç»çš„æ˜¯äºŒé¡¹logisticæ¨¡å‹ï¼Œé€‚ç”¨äºäºŒåˆ†ç±»ï¼Œå¯ä»¥å°†å…¶æ¨å¹¿ä¸ºå¤šé¡¹logisticåˆ†ç±»æ¨¡å‹ï¼Œç”¨äºå¤šç±»åˆ†ç±»ã€‚å‡è®¾ç¦»æ•£å‹éšæœºå˜é‡$Y$çš„å–å€¼é›†åˆæ˜¯$\{1,2,\dots,K\}$,é‚£ä¹ˆå¤šé¡¹logisticå›å½’çš„æ¨¡å‹æ˜¯:
$$
    \begin{aligned}
        P(Y=k|x) &= \frac{\exp(w_k \cdot x)}{1 + \sum_{k=1}^{K-1} \exp(w_k \cdot x)} \\
        P(Y=K|x) &= \frac{1}{1 + \sum_{k=1}^{K-1} \exp(w_k \cdot x)}
    \end{aligned}
$$
è¿™é‡Œ$x \in R^{n+1},w_k \in R^{n+1}$ã€‚äºŒé¡¹logisticå›å½’çš„å‚æ•°ä¼°è®¡æ³•ä¹Ÿå¯ä»¥æ¨å¹¿åˆ°å¤šé¡¹logisticå›å½’

### æœ€å¤§ç†µæ¨¡å‹
æœ€å¤§ç†µæ¨¡å‹ï¼Œæ˜¯ç”±æœ€å¤§ç†µåŸç†æ¨å¯¼å®ç°ã€‚æœ¬éƒ¨åˆ†æŒ‰ç…§ä»¥ä¸‹ç»“æ„ç»„ç»‡:
- æœ€å¤§ç†µåŸç†
- æœ€å¤§ç†µæ¨¡å‹æ¨å¯¼
- æœ€å¤§ç†µæ¨¡å‹å­¦ä¹ 

#### æœ€å¤§ç†µåŸç†
æœ€å¤§ç†µåŸç†æ˜¯æ¦‚ç‡æ¨¡å‹å­¦ä¹ çš„ä¸€ä¸ªå‡†åˆ™ï¼Œæœ€å¤§ç†µåŸç†è®¤ä¸ºï¼š
> å­¦ä¹ æ¦‚ç‡æ¨¡å‹æ—¶ï¼Œåœ¨æ‰€æœ‰å¯èƒ½çš„æ¦‚ç‡æ¨¡å‹ä¸­ï¼Œç†µæœ€å¤§çš„æ¨¡å‹æ˜¯æœ€å¥½çš„æ¨¡å‹ã€‚é€šå¸¸ç”¨çº¦æŸæ¡ä»¶æ¥ç¡®å®šæ¦‚ç‡æ¨¡å‹çš„é›†åˆï¼Œæ‰€ä»¥ï¼Œæœ€å¤§ç†µåŸç†ä¹Ÿå¯ä»¥è¡¨è¿°ä¸ºåœ¨æ»¡è¶³çº¦æŸæ¡ä»¶çš„æ¨¡å‹é›†åˆä¸­é€‰å–ç†µæœ€å¤§çš„æ¨¡å‹ã€‚

æˆ‘ä»¬é¦–å…ˆæ¥å¤ä¹ ä¸‹ä¿¡æ¯è®ºä¸­å…³äºç†µçš„å®šä¹‰ï¼š
> åœ¨ä¿¡æ¯è®ºä¸æ¦‚ç‡ç»Ÿè®¡ä¸­ï¼Œç†µæ˜¯è¡¨ç¤º**éšæœºå˜é‡ä¸ç¡®å®šæ€§**çš„åº¦é‡ï¼Œè®¾$X$æ˜¯ä¸€ä¸ªå–æœ‰é™ä¸ªå€¼çš„ç¦»æ•£éšæœºå˜é‡ï¼Œå…¶æ¦‚ç‡åˆ†å¸ƒä¸º:
> $$
    P(X = x_i) = p_i, \quad i =1,2,\dots,n
> $$
åˆ™éšæœºå˜é‡$X$çš„ç†µå®šä¹‰ä¸º:
$$
    H(X) = - \sum_{i=1}^n p_i \log p_i 
$$

è‹¥$p_i = 0$,åˆ™å®šä¹‰$0\log 0 =0$,å¼ä¸­çš„å¯¹æ•°ä¸€èˆ¬å–ä»¥2ä¸ºåº•æˆ–è€…ä»¥$e$ä¸ºåº•ï¼Œè¿™æ—¶ç†µçš„å•ä½è¢«ç§°ä½œæ¯”ç‰¹æˆ–çº³ç‰¹ï¼Œç”±å®šä¹‰å¯çŸ¥ï¼Œç†µåªä¾èµ–äº$X$çš„åˆ†å¸ƒï¼Œè€Œä¸$X$çš„å–å€¼æ— å…³ï¼Œå› æ­¤ä¹Ÿå¯å°†$X$çš„ç†µè®°ä½œ$H(p)$,ç†µè¶Šå¤§ï¼Œéšæœºå˜é‡çš„ä¸ç¡®å®šæ€§è¶Šå¤§ã€‚å› ä¸º$p_i \leq 0$,ç”±$H(p)$å‡½æ•°æ€§è´¨(å‡¹å‡½æ•°ï¼Œåº”ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•å¯æ±‚æœ€å¤§å€¼)å¯çŸ¥:
$$
    0 \leq H(p) \leq \log n
$$
å½“ä¸”ä»…å½“$X$æ˜¯å‡åŒ€åˆ†å¸ƒæ—¶å³ä¾§ç­‰å·æˆç«‹,ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“$X$æœä»å‡åŒ€åˆ†å¸ƒæ—¶ï¼Œç†µæœ€å¤§ï¼Œè¯¥éšæœºå˜é‡çš„ä¸ç¡®å®šæ€§æœ€å¤§ã€‚ä¸‹é¢ç»™å‡ºæ¡ä»¶ç†µçš„å®šä¹‰:
> è®¾æœ‰éšæœºå˜é‡$(X,Y)$,å…¶è”åˆæ¦‚ç‡åˆ†å¸ƒä¸ºï¼š
$$
    P(X = x_i,Y = y_i) = p_{ij}\quad i = 1,2,\dots,n;\quad j = 1,2,\dots,m
$$
æ¡ä»¶ç†µ$H(Y|X)$è¡¨ç¤ºåœ¨å·²çŸ¥éšæœºå˜é‡$X$æ¡ä»¶ä¸‹éšæœºå˜é‡$Y$çš„ä¸ç¡®å®šæ€§ã€‚éšæœºå˜é‡$X$ç»™å®šçš„æ¡ä»¶ä¸‹éšæœºå˜é‡$Y$çš„æ¡ä»¶ç†µ$H(Y|X)$,å®šä¹‰ä¸º$X$ç»™å®šæ¡ä»¶ä¸‹$Y$çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒçš„ç†µå¯¹$X$çš„æ•°å­¦æœŸæœ›ï¼š
$$
    H(Y|X) = \sum_{i=1}^n p_i H(Y|X = x_i)
$$
å½“ç†µå’Œæ¡ä»¶ç†µä¸­çš„æ¦‚ç‡ç”±æ•°æ®ä¼°è®¡å¾—åˆ°æ—¶ï¼Œæ‰€å¯¹åº”çš„ç†µä¸æ¡ä»¶ç†µåˆ†åˆ«ç§°ä¸ºç»éªŒç†µå’Œç»éªŒæ¡ä»¶ç†µ

ç›´è§‚çš„ï¼Œæœ€å¤§ç†µåŸç†è®¤ä¸ºè¦é€‰æ‹©çš„æ¦‚ç‡æ¨¡å‹é¦–å…ˆå¿…é¡»æ»¡è¶³å·²æœ‰çš„äº‹å®ï¼Œå³çº¦æŸæ¡ä»¶ã€‚åœ¨æ²¡æœ‰æ›´å¤šä¿¡æ¯æƒ…å†µä¸‹ï¼Œé‚£äº›ä¸ç¡®å®šçš„éƒ¨åˆ†éƒ½æ˜¯â€œç­‰å¯èƒ½çš„â€,æœ€å¤§ç†µåŸç†é€šè¿‡ç†µçš„æœ€å¤§åŒ–æ¥è¡¨ç¤ºç­‰å¯èƒ½æ€§ã€‚ä¸‹é¢é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥ä»‹ç»æœ€å¤§ç†µåŸç†ï¼š
> ğŸŒ°ï¼šå‡è®¾éšæœºå˜é‡$X$æœ‰äº”ä¸ªå–å€¼$\{A,B,C,D,E \}$,è¦ä¼°è®¡å–å„ä¸ªå€¼çš„æ¦‚ç‡$P(A),P(B),P(C),P(D),P(E)$
> - ä¸æä¾›ä»»ä½•é¢å¤–çº¦æŸï¼Œåˆ™åªæœ‰è¿™äº›æ¦‚ç‡çš„å›ºæœ‰çº¦æŸ
> $$
    P(A) + P(B) + P(C) + P(D) + P(E) = 1
> $$
> å› ä¸ºæ²¡æœ‰ä»»ä½•é¢å¤–çš„ä¿¡æ¯ï¼Œåˆ™æ ¹æ®æœ€å¤§ç†µåŸç†ï¼Œåªèƒ½å¤Ÿè®¤ä¸ºè¯¥æ¦‚ç‡åˆ†å¸ƒä¸ºå‡åŒ€åˆ†å¸ƒï¼š
> $$
    P(A) = P(B) = P(C) = P(D) = P(E) = \frac{1}{5}
> $$
> - ä»ä¸€äº›å…ˆéªŒçŸ¥è¯†ä¸­å¾—åˆ°äº†ä¸€äº›å¯¹æ¦‚ç‡å€¼çš„çº¦æŸæ¡ä»¶ï¼Œå¦‚$P(A) + P(B) = \frac{3}{10}$,æ»¡è¶³çº¦æŸçš„æ¦‚ç‡åˆ†å¸ƒä»æ—§æœ‰æ— ç©·å¤šä¸ªï¼Œåœ¨ç¼ºå°‘å…¶ä»–ä¿¡æ¯çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è®¤ä¸º$A$å’Œ$B$æ˜¯ç­‰æ¦‚ç‡çš„ï¼Œ$C,D,E$ç­‰æ¦‚ç‡ã€‚

å®é™…ä¸Šï¼Œæœ€å¤§ç†µåŸç†å°±æ˜¯ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§é€‰æ‹©æœ€ä¼˜æ¦‚ç‡æ¨¡å‹çš„å‡†åˆ™(ä¿å®ˆ)

#### æœ€å¤§ç†µæ¨¡å‹çš„å®šä¹‰
æœ€å¤§ç†µåŸç†æ˜¯ç»Ÿè®¡å­¦ä¹ çš„ä¸€èˆ¬åŸç†ï¼Œå°†å®ƒåº”ç”¨åˆ°åˆ†ç±»å¾—åˆ°æœ€å¤§ç†µæ¨¡å‹ã€‚
å‡è®¾åˆ†ç±»æ¨¡å‹æ˜¯ä¸€ä¸ªæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$P(Y|X)$,$X \in \mathcal{X} \subseteq R^n$è¡¨ç¤ºè¾“å…¥ï¼Œ$Y \in \mathcal{Y}$è¡¨ç¤ºè¾“å‡ºï¼Œ$\mathcal{X}$å’Œ$\mathcal{Y}$åˆ†åˆ«æ˜¯è¾“å…¥å’Œè¾“å‡ºçš„é›†åˆï¼Œè¿™ä¸ªæ¨¡å‹è¡¨ç¤ºçš„æ˜¯å¯¹äºç»™å®šçš„è¾“å…¥$X$ï¼Œä»¥æ¡ä»¶æ¦‚ç‡$P(Y|X)$è¾“å‡º$Y$ã€‚
ç»™å®šä¸€ä¸ªè®­ç»ƒæ•°æ®é›†:
$$
    T = \{  (x_1,y_1), (x_2,y_2), \dots, (x_N,y_N)\}
$$
å­¦ä¹ çš„ç›®æ ‡æ˜¯åº”ç”¨æœ€å¤§ç†µæ¨¡å‹é€‰æ‹©æœ€å¥½çš„åˆ†ç±»æ¨¡å‹ã€‚é¦–å…ˆè€ƒè™‘æ¨¡å‹åº”è¯¥æ»¡è¶³çš„æ¡ä»¶ï¼Œå³è¯¥æ•°æ®é›†ä¸ºæ¨¡å‹æ·»åŠ äº†å“ªäº›çº¦æŸï¼Œç»™å®šè®­ç»ƒæ•°æ®é›†åï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šè”åˆåˆ†å¸ƒ$P(X,Y)$çš„ç»éªŒåˆ†å¸ƒå’Œè¾¹ç¼˜åˆ†å¸ƒ$P(X)$çš„ç»éªŒåˆ†å¸ƒï¼Œåˆ†åˆ«ä»¥$\tilde{P}(X,Y)$å’Œ$\tilde{P}(X)$è¡¨ç¤º:
$$
    \begin{aligned}
        \tilde{P}(X= x,Y=y) &= \frac{\nu(X = x,Y = y)}{N} \\
        \tilde{P}(X = x) &= \frac{\nu(X = x)}{N} 
    \end{aligned}
$$
å¼ä¸­$\nu(\cdot)$æ˜¯é¢‘æ•°ç»Ÿè®¡å‡½æ•°ï¼Œ$N$è¡¨ç¤ºè®­ç»ƒæ ·æœ¬å®¹é‡ã€‚ç”¨ç‰¹å¾å‡½æ•°$f(x,y)$æè¿°è¾“å…¥$x$å’Œè¾“å‡º$y$ä¹‹é—´çš„æŸä¸€ä¸ªäº‹å®ï¼Œå…¶å®šä¹‰æ˜¯:
$$
    f(x,y) = \begin{cases}
        1,  &xå’Œyæ»¡è¶³æŸä¸€äº‹å® \\
        0,  &else 
    \end{cases}
$$
ç‰¹å¾å‡½æ•°$f(x,y)$å…³äºç»éªŒåˆ†å¸ƒ$\tilde{P}(X,Y)$çš„æœŸæœ›å€¼ï¼Œç”¨$E_{\tilde{P}}(f)$è¡¨ç¤ºï¼š
$$
    E_{\tilde{P}}(f) = \sum_{x,y} \tilde{P}(x,y) f(x,y)
$$
ç‰¹å¾å‡½æ•°$f(x,y)$å…³äºæ¨¡å‹$P(Y|X)$iä¸ç»éªŒåˆ†å¸ƒ$\tilde{P}(X)$çš„æœŸæœ›å€¼ï¼Œç”¨$E_P(f)$è¡¨ç¤ºï¼š
$$
    E_P(f) = \sum_{x,y} \tilde{P}(x) P(y|x) f(x,y)
$$
å¦‚æœæ¨¡å‹èƒ½å¤Ÿè·å–è®­ç»ƒæ•°æ®ä¸­çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥å‡è®¾è¿™ä¸¤ä¸ªæœŸæœ›å€¼ç›¸ç­‰ï¼Œå³ï¼š
$$
    E_P(f) = E_{\tilde{P}}(f)
$$
å°†è¿™ä½œä¸ºæ¨¡å‹å­¦ä¹ çš„çº¦æŸæ¡ä»¶ï¼Œå‡å¦‚æœ‰$n$ä¸ªç‰¹å¾å‡½æ•°$f_i(x,y),i=1,2,\dots,n$,é‚£ä¹ˆå°±æœ‰$n$ä¸ªçº¦æŸæ¡ä»¶ï¼Œä¸‹é¢ç»™å‡ºæœ€å¤§ç†µæ¨¡å‹çš„å®šä¹‰:
> æœ€å¤§ç†µæ¨¡å‹:å‡è®¾æ»¡è¶³æ‰€æœ‰çº¦æŸæ¡ä»¶çš„æ¨¡å‹é›†åˆä¸º:
> $$
    C \equiv \{ P \in \mathcal{P} |E_P(f_i) = E_{\tilde{P}}(f_i), i = 1,2,\dots,n\} 
> $$
> å®šä¹‰åœ¨æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$P(Y|X)$ä¸Šçš„æ¡ä»¶ç†µä¸ºï¼š
> $$
    H(P) = -\sum_{x,y}  \tilde{P}(x)P(y|x) log P(y|x)
> $$
> åˆ™æ¨¡å‹é›†åˆ$C$ä¸­æ¡ä»¶ç†µ$H(P)$æœ€å¤§çš„æ¨¡å‹ç§°ä¸ºæœ€å¤§ç†µæ¨¡å‹

ä»å®šä¹‰å¯ä»¥çœ‹å‡ºï¼Œæœ€å¤§ç†µæ¨¡å‹æ˜¯åŸºäºè¿™æ ·ä¸€ç§æ€æƒ³:
> å½“æˆ‘ä»¬éœ€è¦å¯¹ä¸€ä¸ªäº‹ä»¶(å˜é‡)çš„æ¦‚ç‡åˆ†å¸ƒè¿›è¡Œé¢„æµ‹æ—¶ï¼Œæœ€å¤§ç†µåŸç†å‘Šè¯‰æˆ‘ä»¬æ‰€æœ‰çš„é¢„æµ‹åº”å½“æ»¡è¶³å…¨éƒ¨å·²çŸ¥çš„æ¡ä»¶(çº¦æŸ)ï¼Œè€Œå¯¹æœªçŸ¥çš„æƒ…å†µä¸è¦åšä»»ä½•ä¸»è§‚å‡è®¾ï¼Œä¿ç•™æ¨¡å‹æœ€å¤§çš„ä¸ç¡®å®šæ€§ã€‚

#### æœ€å¤§ç†µæ¨¡å‹çš„å­¦ä¹ 
æœ€å¤§ç†µæ¨¡å‹çš„å­¦ä¹ è¿‡ç¨‹å°±æ˜¯æ±‚è§£æœ€å¤§ç†µæ¨¡å‹çš„è¿‡ç¨‹ã€‚æœ€å¤§ç†µæ¨¡å‹å­¦ä¹ å¯ä»¥å½¢å¼åŒ–ä¸ºçº¦æŸæœ€ä¼˜åŒ–é—®é¢˜ã€‚
å¯¹äºç»™å®šçš„è®­ç»ƒæ•°æ®é›†$T = \{ (x_1,y_1), (x_2,y_2),\dots, (x_N,y_N)\}$ä»¥åŠç‰¹å¾å‡½æ•°$f_i(x,y),i=1,2,\dots,n$,æœ€å¤§ç†µæ¨¡å‹çš„å­¦ä¹ ç­‰ä»·äºæ±‚è§£æœ€ä¼˜åŒ–é—®é¢˜:
$$
    \begin{aligned}
        &\max_{P \in C} \quad H(P) = -\sum_{x,y}  \tilde{P}(x)P(y|x) log P(y|x) \\
        &s.t. \quad E_P(f_i) = E_{\tilde{P}}(f_i),\quad i =1,2,\dots,n \\  
        & \quad \quad \sum_y P(y|x) =1
    \end{aligned}
$$
æŒ‰ç…§æœ€ä¼˜åŒ–é—®é¢˜çš„ä¹ æƒ¯ï¼Œå°†æ±‚è§£æœ€å¤§å€¼é—®é¢˜æ”¹ä¸ºç­‰ä»·çš„æ±‚æœ€å°å€¼é—®é¢˜:
$$
    \begin{aligned}
        &\min_{P \in C} \quad -H(P) = \sum_{x,y}  \tilde{P}(x)P(y|x) log P(y|x) \\
        &s.t. \quad E_P(f_i) - E_{\tilde{P}}(f_i) = 0,\quad i =1,2,\dots,n \\  
        & \quad \quad \sum_y P(y|x) =1
    \end{aligned}
$$
**è¯¥ä¼˜åŒ–é—®é¢˜æŒ‰ç…§æèˆªè€å¸ˆã€Šç»Ÿè®¡å­¦ä¹ ã€‹ä¸­çš„è¯´æ³•æ˜¯æ»¡è¶³å¼ºå¯¹å¶æ€§çš„ï¼Œä½†ä¹¦ä¸­åªæ˜¯ä¸€å¸¦è€Œè¿‡ï¼Œå¹¶æ²¡æœ‰è¿›è¡Œè¯¦ç»†è¯´æ˜ï¼Œæ­¤å¤„ç•™å‘ï¼Œåé¢çš„æ¨å¯¼å°±å…ˆé»˜è®¤è¯¥ä¼˜åŒ–é—®é¢˜æ»¡è¶³å¼ºå¯¹å¶æ€§ï¼Œåé¢æˆ‘ææ‡‚äº†å†æ¥å¡«å‘**
***
**è¿™ä¸ªé—®é¢˜æˆ‘åˆæ€è€ƒäº†ä¸€ä¸‹ï¼Œè‡ªå˜é‡æ˜¯ä¸€ä¸ªåˆ†å¸ƒçœ‹ä¼¼æ˜¯ä¸€ä¸ªå¾ˆè™šçš„ä¸œè¥¿ï¼Œä½†å®ƒä¹Ÿä¸è¿‡æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè‹¥$X,Y$éƒ½æ˜¯ç¦»æ•£å–å€¼å˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒåªæ˜¯ä¸€ä¸ªæœ‰é™é•¿åº¦çš„å‘é‡ï¼Œè€Œè‹¥$X,Y$å–å€¼è¿ç»­ï¼Œåˆ™è¯¥æ¡ä»¶æ¦‚ç‡å¯†åº¦å‡½æ•°å¯ä»¥çœ‹ä½œä¸€ä¸ªæ— é™é•¿çš„å‘é‡ï¼Œè¿™æ ·æ¥çœ‹åŸå§‹å¾…ä¼˜åŒ–å‡½æ•°å…¶å®å°±æ˜¯$\boldsymbol{x} \cdot \log \boldsymbol{x}$,è¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå‡¸å‡½æ•°ï¼Œè€Œçº¦æŸæ¡ä»¶ä¹Ÿä¸è¿‡æ˜¯å¾…ä¼˜åŒ–å‚æ•°çš„çº¿æ€§ç»„åˆï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå‡¸ä¼˜åŒ–é—®é¢˜**
***
è¯¥ä¼˜åŒ–é—®é¢˜å…±æœ‰$n+1$ä¸ªç­‰å¼çº¦æŸï¼Œå› æ­¤è€ƒè™‘å¼•å…¥æ‹‰æ ¼æœ—æ—¥ä¹˜å­$w_0,w_1,\dots,w_n$,å®šä¹‰æ‹‰æ ¼æœ—æ—¥å‡½æ•°$L(P,w)$:
$$
    \begin{aligned}
        L(P,w) &= -H(P) + w_0 (1 - \sum_y P(y|x)) + \sum_{i=1}^n w_i (E_{\tilde{P}}(f_i) - E_P(f_i)) \\
        &= \sum_{x,y}  \tilde{P}(x)P(y|x) log P(y|x)  + w_0 (1 - \sum_y P(y|x)) \\
        &+ \sum_{i=1}^n w_i(\sum_{x,y} \tilde{P}(x,y) f(x,y) - \sum_{x,y} \tilde{P}(x) P(y|x) f(x,y))
    \end{aligned}
$$
åŸå§‹ä¼˜åŒ–é—®é¢˜çš„å¯¹å¶é—®é¢˜å†™ä½œï¼š
$$
    \max_{w} \min_{P} L(P,w)
$$
é¦–å…ˆæ±‚è§£å¯¹å¶å‡½æ•°$\phi(w)$,å› ä¸º$L(P,w)$å…³äº$P$æ˜¯å‡¸å‡½æ•°ï¼Œå› æ­¤ç›´æ¥é€šè¿‡æ±‚å¯¼ä»¤å¯¼æ•°ä¸º0å³å¯ï¼š
$$
    \begin{aligned}
        \frac{ \partial L(P,w)}{\partial P(y|x)} &=  log P(y|x) +1 - w_0 - \sum_{i=1}^n w_i f_i (x,y) = 0 
    \end{aligned}
$$
åœ¨æ±‚å¯¼è¿™ä¸€éƒ¨åˆ†æˆ‘ä¸å¤ªè®¤åŒæèˆªè€å¸ˆä¹¦ä¸­çš„å†™æ³•ï¼Œå› ä¸º$P(y|x)$æœ¬èº«å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªå‘é‡ï¼Œå› æ­¤æ±‚å¯¼ç›¸å½“äºå¯¹è¯¥å‘é‡æŸä¸ªåˆ†é‡æ±‚å¯¼ã€‚ç”±æ­¤å¯å¾—$P(y|x)$çš„è§£æè¡¨è¾¾å¼:
$$
    P(y|x) = \exp(\sum_{i=1}^n w_i f_i(x,y) + w_0 -1) = \frac{\exp(\sum_{i=1}^n w_i f_i(x,y))}{\exp(1-w_0)}
$$
åˆå› ä¸ºæœ‰æ¦‚ç‡å¯†åº¦å‡½æ•°çš„å›ºæœ‰çº¦æŸ$\sum_y P(y|x) = 1$,å¯å¾—:
$$\exp(1-w_0) = \sum_y \exp(\sum_{i=1}^n w_i f_i(x,y))$$
å› æ­¤ï¼Œ$P_w(y|x)$çš„è§£æè¡¨è¾¾å¼å†™ä½œ:
$$
    \begin{aligned}
        P_w(y|x) &= \frac{1}{Z_w(x)} \exp(\sum_{i=1}^n w_i f_i(x,y)) \\
        Z_w(x) &= \sum_y \exp(\sum_{i=1}^n w_i f_i(x,y))
    \end{aligned}
$$
è‡³æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°äº†å¯¹å¶å‡½æ•°$\phi(w)$è¡¨è¾¾å¼ï¼š
$$
    \begin{aligned}
        \phi(w) = 
    \end{aligned}
$$
å¾—åˆ°$w^\ast$,ç„¶åå›ä»£$P_w(y|x)$,å¾—åˆ°æœ€å¤§ç†µæ¨¡å‹è¡¨è¾¾å¼:
$$
    P_{w^\ast}(y|x)
$$
#### æå¤§ä¼¼ç„¶ä¼°è®¡
è¿™ä¸€éƒ¨åˆ†æ—¨åœ¨è¯æ˜ä¸€æ¡æ€§è´¨:
> æœ€å¤§ç†µæ¨¡å‹æ±‚è§£è¿‡ç¨‹ä¸­ï¼Œå¯¹å¶å‡½æ•°çš„æå¤§åŒ–ç­‰ä»·äºæœ€å¤§ç†µæ¨¡å‹çš„æå¤§ä¼¼ç„¶ä¼°è®¡

é¦–å…ˆå†™å‡ºå¯¹æ•°ä¼¼ç„¶å‡½æ•°çš„å½¢å¼:
$$
    \begin{aligned}
         L_{\tilde{P}}(P_w) &= \log \prod_{x,y} P(y|x)^{\tilde{P}(x,y)} = \sum_{x,y} \tilde{P}(x,y) \log P(y|x) \\
         &= \sum_{x,y} \tilde{P}(x,y) \sum_{i=1}^n w_i f_i(x,y)  - \sum_{x,y} \tilde{P}(x,y) \log Z_w(x) \\
         &= \sum_{x,y} \tilde{P}(x,y) \sum_{i=1}^n w_i f_i(x,y)  - \sum_{x} \tilde{P}(x) \log Z_w(x)
    \end{aligned}
$$
