---
title: 规则学习
date: 2020-08-27 20:05:51
tags: 规则学习，定性关联
categories: 统计学习
mathjax: true
toc: true 
---
首先讲一个有意思的现象，早期的主流人工智能专注于以逻辑为基础来进行形式化和推理，但这样很难定量地对不确定事件进行表达和处理，后来随着机器学习算法的井喷，大家都更加关注于对定量的数据进行处理。但现在，很多人发现在解决某些任务的时候，加入一些行业中的常识知识可能会让任务解决地更好，而现在定性知识与定量数据之间似乎有着一道鸿沟，唯一的联系就是进行算法设计的人可能会依赖于他的领域知识来选择合适的算法并对算法进行调参。基于学习下定性知识如何表达的想法，这部分介绍下周志华老师🍉书的倒数第二章——规则学习，这部分内容安扎以下结构组织:
- 基本概念 
- 序贯覆盖
- 剪枝优化
- 一阶规则学习
- 归纳逻辑程序设计 

<!--more-->

### 基本概念
首先给出机器学习中规则和规则学习的概念：
> **规则:** 在机器学习领域中，“规则”通常是指语义明确、能描述数据分布所隐含的客观规律或领域概念，可以写成"若....,则...."形式的逻辑规则。
> **规则学习:** “规则学习”是从训练数据中学习出一组能用于对未见示例进行判别的规则。

形式化来看，一条规则形如：
$$
    \oplus \leftarrow f_1 \land f_2 \dots \land f_L
$$
公式中$\leftarrow$右侧部分称为"规则体"，表示该条规则的前提，左边部分称为"规则头",表示该条规则的结果。规则体是由逻辑文字$f_k$所组成的合取式(conjuction)，每个文字$f_k$都是对示例属性进行检验的布尔表达式，例如"(色泽 = 乌黑)"或者"$\neg$(根蒂 = 硬挺)"。$L$是规则体中逻辑文字的个数,称为规则的长度,规则头的"$\oplus$",同样是逻辑文字，一般用来表示所判定的目标的类别或概念，比如"好瓜"，这样的逻辑规则也被称为**if-then规则**。
与神经网络、支持向量机这样的"黑箱模型"相比，规则学习具有以下几个优点:
- 可解释性较强
- 很强的表达能力，绝大多数的人类知识都能够通过数理逻辑进行简洁的刻画和表达，例如"父亲的父亲是爷爷"这样的知识不易用函数式表达，而用一阶逻辑则可以方便地写为：
$$
    爷爷(X,Y) \leftarrow 父亲(X,Z) \land 父亲(Z,Y)
$$
- 逻辑规则的抽象描述能力在处理一些高度复杂的AI任务时具有显著的优势，例如在问答系统中有时可能遇到非常多、甚至无穷种可能的答案，此时若能基于逻辑规则进行抽象表述或者推理，则将带来极大的便利。

假设我们从西瓜数据集中学得规则集合$\mathcal{R}$:
$$
    \begin{aligned}
        &规则1: 好瓜 \leftarrow (根蒂 = 蜷缩) \land (脐部 = 凹陷) \\
        &规则2: \neg好瓜 \leftarrow (纹理 = 模糊)
    \end{aligned}
$$
规则集合中的每条规则都可看作一个子模型，规则集合是这些子模型的一个集成。当同一个示例被判别结果不同的多条规则覆盖时，则称发生了“冲突”，解决冲突的办法则称为"冲突消解"，常用的冲突消解的方法有投票法、排序法、元规则法，投票法就是常用的少数服从多数策略，排序法则是指定规则优先级，出现冲突时使用排序靠前的规则。所谓元规则，其实就是规则的规则，例如"发生冲突时使用长度最小的规则“，然后根据元规则的指导来使用规则集。
此外，从训练集学得的规则集合也许并不能覆盖所有可能的未见示例，此时规则学习算法通常会设置一条默认规则，由它来处理规则集合未覆盖的样本；例如为$\mathcal{R}$增加一条默认规则：“未被规则1,2覆盖的都不是好瓜”。
从形式语言表达能力而言，规则可分为两类：“命题规则”和“一阶规则”：
> - 命题规则是由“原子命题(propositional atom)”和逻辑连接词“与($\land$)”、"(或($\lor$))"、“非($\neg$)”和“蕴含”($\leftarrow$)构成的简单陈述句；例如规则集$\mathcal{R}$就是一个命题规则集，"根蒂 = 蜷缩"，“脐部 = 凹陷”都是元子命题。
> - 一阶规则的基本成分是能表述事物的属性或关系的"原子公式"，例如表达父子关系的谓词(predict)“父亲$(X,Y)$”就是原子公式，再如表示加1操作"$\sigma(X) = X+1$"的函数$\sigma(X)$也是原子公式。如果进一步使用谓词“自然数$(X)$”表示$X$是自然数，“$\forall X$”表示对任意$X$成立，"$\exists Y$"表示"存在$Y$使之成立",那么"所有自然数加1都是自然数"就可以写做:
> $$
    \forall X, \exists Y  \leftarrow 自然数(X) \land (Y = \sigma(X))
> $$
> 或者表示成更加简洁的形式:
> $$
    \forall X, 自然数(\sigma(X)) \leftarrow 自然数(X)
> $$
> 这样的规则就是一阶规则，其中$X$和$Y$称为逻辑变量，$\forall,\exists$用于限定变量的取值范围，称为"量词"，显然，一阶规则可以表达复杂的关系，因此也被称为“关系型规则”。若我们简单地把属性当作谓词来定义示例与属性值之间的关系，则命题规则集$\mathcal{R}$可以改写为一阶规则集$R'$:
> 
