---
title: 指数族分布与广义线性模型
date: 2020-10-07 10:15:29
tags: 指数分布族， 广义线性模型 
categories: 统计学习 
toc: true 
mathjax: true 
---
在[再谈极大似然估计](https://soundofwind.top/2020/08/24/zai-tan-ji-da-si-ran-gu-ji-qiu-jie/)中已经讨论过指数分布族的概念，并且推导出了若概率分布是指数分布族分布，则最终的对数似然函数一定是一个凹函数，直接求偏导等于0便可得到参数估计。

在听了[朱军老师](http://ml.cs.tsinghua.edu.cn/~jun/index.shtml)的关于指数分布族函数的讲解之后，发现可以从一个更加general的角度来对指数分布族函数来进行把握，而之前得到的凹性结论也不过是其中一小部分而已，该部分按照以下结构组织: 

- 简要回顾指数分布族 
- 配分函数$A(\theta)$的性质 
- 从指数分布族到广义线性模型 
- 广义线性模型性质 

<!--more--> 

### 简要回顾指数分布族函数 
首先给出指数分布族的定义:
> 指数分布族是一类概率分布的总称，这类分布的概率密度函数具有这样的形式：
> $$
    p_\theta(x) = h(x) \exp(\theta^T \phi(x) - A(\theta))
> $$
> 式中，$x$是密度函数自变量，$x \in \mathcal{X}$;$\phi(x)$是充分统计量，可以看做是原始变量的一个映射:
> $$
    \phi: \mathcal{X} \rightarrow R^d
> $$
> $\theta$是模型参数向量，与充分统计量维度相同，$h(x)$是一个只与$x$有关的统计量，$A(\theta)$为配分函数，通过该函数来保证$p_\theta(x)$满足概率密度函数的定义：
> $$
     \int_{\mathcal{X}} p_{\theta}(x) dx = 1
> $$
> 由此约束条件，我们可以得到$A(\theta)$的解析表达式：
> $$
    A(\theta) = \log (\int h(x) \exp(\theta^T \phi(x))dx )
> $$

同时概率密度函数我们也可以写成如下的形式:
$$
    p_\theta(x) = \frac{1}{Z(\theta)}  h(x) exp(\theta^T \phi(x))
$$
其中$Z(\theta) = exp(A(\theta))$,我们日常见到的很多分布都可以转化成指数分布族标准形式，比如: 伯努利分布，多项式分布，高斯分布，gamma分布等，一些变换的例子可以参考[`再谈极大似然估计`](https://soundofwind.top/2020/08/24/zai-tan-ji-da-si-ran-gu-ji-qiu-jie/)
 

### 配分函数$A(\theta)$的性质 

#### $A(\theta)$性质
在之前证明$A(\theta)$的凸性性质时，所采用的方法是按照配分表达式直接证，通过赫尔德不等式可以从定义上证明其是凸函数，但其实$A(\theta)$具有更加一般的性质。 

$A(\theta)$其实是充分统计量$\phi(x)$的中心矩生成函数(moment generating function),这意味着:
$$
  \begin{aligned}
      \nabla_{\theta} A(\theta) &= E_{p_{\theta}(x)}[\phi(x)] \\ 
      \nabla_{\theta}^2 A(\theta) &= Var[\phi(x)]  \\ 
      & ... \\
      \nabla_{\theta}^k A(\theta) &= E_{p_\theta(x)} [(\phi(x) - E[\phi(x)])^k]
  \end{aligned}
$$
下面以一阶统计量为例做一下简单推导:
$$
    \begin{aligned}
        \nabla_{\theta}A(\theta) & = \nabla_{\theta} \log(Z(\theta)) \\
        &= \frac{1}{Z(\theta)} \nabla_{\theta} (\int_x h(x) \exp(\theta^T \phi(x)) dx) \\
        &= \frac{1}{Z(\theta)} \int_x h(x) \phi(x) \exp(\theta^T \phi(x))dx \\ 
        &= \int_x \frac{1}{Z(\theta)} h(x) \exp(\theta^T \phi(x)) \phi(x) dx \\ 
        &= \int_x p(x|\theta) \phi(x) dx \\
        &= E_{p_\theta(x)}[\phi(x)] 
    \end{aligned}
$$

$A(\theta)$的上述性质可以导出一些非常好用的结论:
- 如果记:
$$
    \nabla_{\theta} A(\theta) = E_{p_{\theta}(x)} [\phi(x)] \overset{\triangle}{=} \mu 
$$
这里$\mu$一般被称作矩参数或者均值参数，对于不同的指数分布族函数，一般都可以找到一个双射函数$\psi$,使得:
$$
    \theta \overset{\triangle}{=} \psi(\mu)
$$
这就建立了均值参数与模型的自然参数之间的一一映射关系，在参数估计时如果得到了均值参数估计，同时直到映射关系$\psi$，那么便可以直接得到模型自然参数$\theta$的估计。

- 因为$\nabla_{\theta}^2 A(\theta) = Var[\phi(x)]$，而我们知道一个向量变量的协方差矩阵至少是半正定的，也就是说:
$$
    \nabla_{\theta}^2  A(\theta)= Var[\phi(x)] \succeq 0
$$
这也就直接证明了$A(\theta)$的二阶海塞矩阵半正定，即$A(\theta)$是关于$\theta$的凸函数。

#### $iid$条件下样本集分布$p(D|\theta)$ 
在独立同分布假设下，我们通过采样得到样本集$D = \{ x_1, x_2, \dots, x_N \}$, 在进行参数估计时我们往往需要计算整个样本集出现的概率:
$$
    \begin{aligned}
        p(D|\theta) &= \prod_{i} h(x_i) \exp(\theta^T \phi(x_i) - A(\theta)) \\ 
        &= (\prod_i h(x_i)) \exp(\theta^T \sum_i \phi(x_i) - N A(\theta))
    \end{aligned}
$$
从格式上来看，会发现样本集的分布仍然是指数族分布，只不过是充分统计量$\phi'(D)$变为了:
$$
    \phi'(D) = \sum_i \phi(x_i)
$$
这给我们一个启示，当我们要利用一组数据进行参数估计时，我们只需要将各个样本的充分统计量累加起来便可以得到整个样本集合的充分统计量，后面进行参数估计时只需要利用充分统计量即可，原始数据可以舍弃。

在

