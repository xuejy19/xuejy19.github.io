---
title: 马尔可夫网络
date: 2020-07-25 09:20:59
categories: 统计学习
toc: true
mathjax: true
---
在这一部分我将介绍另一种常见的概率图模型:马尔可夫网络，或称马尔可夫随机场。接下来分为以下几部分进行组织<!--more-->：
- 马尔可夫网络
- 独立性假设
- 势函数

### 马尔可夫网络
首先给出维基百科上关于马尔可夫网络的定义：
> 马尔可夫网络是一组有马尔可夫性质随机变量$X$的全联合概率分布模型。马尔可夫网络类似贝叶斯网络用于表示依赖关系。但是，一方面它可以表示贝叶斯网络无法表示的一些关系，如循环依赖；另一方面，它不能表示贝叶斯网络能够表示的某些关系，如推导关系。

马尔可夫网络具有以下特征：
- 无向图$H = (V,E)$
- 每个顶点$v \in V$表示一个在集合$X$的随机变量，每条边$\{u,v\}\in E$ 表示随机变量$u$和$v$之间的依赖关系

### 独立性假设
马尔可夫网络与贝叶斯网络类似，以图的形式对独立性假设进行编码，首先给出图中激活路径的概念：
- 激活路径：一个路径$X_1,X_2,\dots,X_n$是激活的 $\Leftrightarrow$ 没有路径上的变量被观测到  

有了激活路径概念之后，便可以讨论图中的条件独立关系：
- 在图$H$中，节点集$X$与节点集$Y$相对于是节点集$Z$是分离的 $\Leftrightarrow$ $X$与$Y$之间不存在激活路径
- 表示为$sep_H(X;Y|Z)$,栗子如下图所示。

![栗子](https://raw.githubusercontent.com/xuejy19/Images/master/mav1.png)

### 势函数
在贝叶斯网络中，节点之间的关系通过条件概率进行表征，而在马尔可夫网络中，节点之间的关系通过势函数来表征，势函数定义如下：
> 一个函数集合$f_k$(也称为因子或者团因子有时也称为特征)，每一个$f_k$的定义域是图$G$的团或子团$k$,每一个$f_k$是从可能的特定联合的指派(到元素$k$)到非负实数的映射。

总结而言，势函数具有以下特征：
> - 非负
> - 与条件概率不同，其求和不必为1

### 吉布斯分布 
我们引入该图模型的目的在于：**通过马尔可夫网络来对变量之间的独立性关系进行编码，然后获得对于联合概率分布更加紧凑的表示形式**，而吉布斯分布便是将联合概率与势函数相连接的桥梁。
一个概率分布$P$可以分解为图$H$：
> - $H$可以分为若干子团$D_i$
> - 在每个子团上相应定义了势函数$\pi_i$

由此便可以写出吉布斯分布形式：
$$
\begin{aligned}
     P(X_1,X_2,\dots,X_n) = \frac{1}{Z} f(X_1,X_2,\dots,X_n) 
\end{aligned}  
$$

其中:
> - $f(X_1,X_2,\dots,X_n) = \prod_{i=1}^m \pi_i(D_i)$
> - $Z = \sum_{X_1,\dots,X_n} f(X_1,\dots,X_n)$

每一个势函数定义了一个映射:$Sub(X) \rightarrow \mathcal{R^+}$ ,一个势函数的定义域相当于是一个集合，而这个集合中的变量彼此之间是直接依赖关系，从这个视角来看，条件概率可以看作是势函数的特例(仅仅表征两个变量之间依赖关系)。

下面我们讨论下一个势函数(因子)应该定义在一个多大的集合上，首先考虑如果在每条边上均定义一个势函数，那么马尔可夫网络能否表征联合概率分布？答案是并不行，为此我以一个7个节点(均为二值变量)的全连接网络为例，分别讨论两种情况下具有的独立参数的数量：
- 联合概率分布：$2^7 - 1 = 127$
- 边上势函数：$4*C_7^2 = 84$

显然对于全连接网络，若给予每个边一个势函数并不足以表征联合概率分布，在前面已经说明一个势函数定义域中的变量应当是两两直接相关，因此势函数的定义域应当是一个团(clique)。
$\Rightarrow$ **马尔可夫网络中的局部结构是团**

### 马尔可夫网络分解
首先给出$I-Map$的概念:$H$为一个马尔可夫网络，$P$为联合概率分布，若有$I(H) \subseteq I(P)$，则称马尔可夫网络$H$为分布$P$的一个$I-Map$。 

记$D_i$为马尔可夫网络$H$中的子团，Hammersley-Clifford定理如下：
> 对于一个无向图$H$和分布$P$,$P$可以被分解成$P(X) = \frac{1}{Z}\prod \pi_i (D_i) \Leftrightarrow$ $H$是$P$的$I-Map$

在实际进行分解时一般都是在最大团上定义势函数

### 对数表示
在马尔可夫网络中，联合分布除了可以利用吉布斯分布来进行表示，也可以采取对数表示的方法，将原始的势函数$\pi_i(D_i)$ 表示成$exp(-\epsilon(D_i))$的形式，其中$\epsilon(D_i) = -log(\pi_i(D_i))$,据此，联合概率分布可以表示成：
$$
    P(X_1,X_2,\dots,X_n) = \frac{1}{Z} exp(-\sum_{i=1}^m \epsilon(D_i))
$$
这种表示方法将连乘变成了连家，计算更加方便，同时有定理证明，若无向图$H$是分布$P$的一个独立映射，那么$\epsilon(D_i) = \omega_i \phi_i(D_i)$,此时$\phi$被称作特征函数，与势函数关系为：
$$
    \pi_i(D_i) = exp(\omega_i \phi_i(D_i))
$$