---
title: 自编码器AE
date: 2020-10-10 20:20:27
tags: 自编码，变分自编码，降噪自编码 
categories: 统计学习 
mathjax: true 
toc: true 
---
在进行数据降维和数据降噪时常用的深度学习方法是自编码器`AutoEncoder`类算法，其具有以下特点:
- 自编码器类算法属于无监督学习范畴
- 从结构上来看自编码器类算法包含编码器和解码器两部分 
- 自编码器算法常用做特征提取 

本文按照以下结构进行组织:
- 自编码器AE
- 变分自编码器VAE 
- 降噪自编码器DAE 
<!--more-->
### 自编码器AE  

#### 自编码器算法思想 
所谓的自编码器从名称上来理解，便是对自己进行编码，首先给出维基百科上关于自编码器的定义:
> **自编码器:** 自编码，也称自动编码器，是一种人工神经网络，在无监督学习中用于有效编码。自编码的目的是对一组数据学出一种表示，通常用于降维。 

一个自编码器一般具有如下结构: 
![自编码器](https://raw.githubusercontent.com/xuejy19/xuejy19.github.io/source/Img/AE.png)

从上图可以看出，自编码器模型主要由编码器和解码器组成，其主要目的是将输入变量映射到中间变量$z$，然后再将中间变量$z$映射成$x'$， 模型训练的目标是$x$和$x'$尽可能接近，编码器和解码器分别实现了以下功能: 
- 编码器: 将输入数据映射到隐含特征空间 
- 解码器: 基于隐含特征来重构原始数据 

单纯从形式上来看，自编码器就是一个普通的神经网络，只是网络输出为输入数据本身；但如果从算法思想的角度，我们一般所接触的神经网络所开展的任务往往是有监督学习问题，比如分类和回归预测，而对于无监督学习问题，比如聚类、降维，还是统计学习中的一些传统算法应用较多，而自编码器则就给予了我们一个应用深度学习方法来开展无监督学习的思路。

初学者在开展自编码器学习过程中绕不开的一个问题就是:
> 训练这样一个恒等映射网络有什么意义? 

我在刚了解自编码器算法思想时也有这样的疑问，但在对无监督学习思想有了更多理解之后我认为构建这样一个恒等映射网络有以下几方面应用: 
- **数据压缩/降维:** 在图像压缩领域，一个图像可能动辄几MB甚至几十MB，在进行传输中需要大量的流量，而假设我们已经有了一个训练好的自编码神经网络，而特征空间维度较低，我们就可以在发送端应用训练好的自编码器进行数据压缩，然后将压缩后的数据传输到接收端，接收端再使用解码器来对图像进行还原。
- **特征提取:** 数据压缩本身也是一种特征提取，而具体提取什么样的特征则是与数据相关的，而自编码器提取特征的标准则是希望提取的隐层特征能够在自编码器神经网络框架下较精确地重构原始数据，提取后的特征可以送入下游机器学习算法中以完成下游任务。

在进行自编码器算法应用时，需要注意以下两点问题: 
- 自动编码器是数据相关的，这也就意味着自动编码器只能压缩那些与训练数据类似的数据，如果从概率分布的角度来进行理解，编码器其实就是学到了一个映射，将原始空间的数据分布映射到特征空间的某个概率分布，这也就意味着如果模型训练的比较充分且新来的样本与训练样本同分布，则自编码器就能较好地对新样本数据进行编码。 
- 自动编码器是有损的，这是因为经过编码解码后的输出与输入相比还是有误差的/退化的，这个误差我们一般称之为重构误差。
- 自动编码器算法属于一种无监督学习算法。

#### 自编码器搭建及学习 

自编码器其实可以看作一整个神经网络，包含编码器与解码器两部分，分别学习不同的映射: 
$$
    \begin{aligned}
        &Encoder: x \rightarrow f(x) \quad \mathbb{R}^d \rightarrow \mathbb{R}^{d'}\\ 
        &Decoder: f(x) \rightarrow x' \quad \mathbb{R}^{d'} \rightarrow \mathbb{R}^d
    \end{aligned}
$$
如果对自编码器的算法思想理解了同时具备神经网络搭建训练方面的知识，则自编码器的搭建及训练不需要再单独学习。

#### 常见自编码器类型 
常用自编码器有以下集中几种类型: 
- **堆栈自编码器**: 所谓堆栈自编码器实际上就是最普通的自编码器，编码器和解码器网络结构层数均大于1。
- **欠完备自编码器**: 如果编码器输出特征维度$h$小于原始数据特征维度$d$，则对应的自编码器称为欠完备自编码器，在进行数据降维时一般都是采用欠完备自编码器。
- **正则自编码器**: 普通的堆栈自编码器只是学习了一个恒等映射，而我们有时候期望降维后的特征能够具有某些特性，这些特性包括系数表示、对噪声鲁棒性等，而要达成这样的目的往往会在目标函数上添加一个正则项。
- **降噪自编码器**: 降噪自编码器与其说是一个算法结构，实际上更像是一种模型训练的trick，降噪自编码器以损坏/缺失的数据作为输入，然后来预测原始的未损坏/缺失的数据，从而使自编码器学习到从缺失数据恢复为未缺失数据的能力。   
### 变分自编码器VAE 
